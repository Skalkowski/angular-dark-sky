!function(){"use strict";function a(){var a,b={baseUri:"https://api.darksky.net/forecast/",baseExclude:"&exclude=",acceptedUnits:["auto","ca","uk2","us","si"],acceptedLanguage:["ar","az","be","bs","cs","de","el","en","es","fr","hr","hu","id","it","is","kw","nb","nl","pl","pt","ru","sk","sr","sv","tet","tr","uk","x-pig-latin","zh","zh-tw"]},c="us",d="en";this.setApiKey=function(b){return a=b,this},this.setUnits=function(a){return _.indexOf(b.acceptedUnits,a)===-1&&console.warn(a+" not an accepted API unit."),c=a,this},this.setLanguage=function(a){return _.indexOf(b.acceptedLanguage,a)===-1&&console.warn(a+" not an accepted API language."),d=a,this},this.$get=["$http","$q","$sce",function(e,f,g){function i(a,b,c){return p(a,b,c).current()}function j(a,b,c){return p(a,b,c).daily()}function k(a,b,c){return p(a,b,c).hourly()}function l(a,b,c){return p(a,b,c).minutely()}function m(a,b,c){return p(a,b,c).alerts()}function n(a,b,c){return p(a,b,c).flags()}function o(){var a,b="us";switch(c&&("auto"===c?(console.warn("Can't guess units. Defaulting to Imperial"),b="us"):b=c),b){case"ca":a=v();break;case"uk2":a=w();break;case"us":a=t();break;case"si":a=u()}return a}function p(a,b,c){var d;return c&&c.time&&(d=c.time,moment(d).isValid()||console.warn("Specified time is not valid")),{current:function(){var e=q("currently")+r(c);return s(a,b,e,d)},daily:function(){var e=q("daily")+r(c);return s(a,b,e,d)},hourly:function(){var e=q("hourly")+r(c);return s(a,b,e,d)},minutely:function(){var e=q("minutely")+r(c);return s(a,b,e,d)},alerts:function(){var e=q("alerts")+r(c);return s(a,b,e,d)},flags:function(){var e=q("flags")+r(c);return s(a,b,e,d)}}}function q(a){var c=["alerts","currently","daily","flags","hourly","minutely"],d=_.without(c,a),e=_.join(d,",");return b.baseExclude+e}function r(a){var b={extend:!1},c=_.defaults(a,b),d="";a&&c.extend&&(d+="&extend=hourly")}function s(h,i,j,k){var k=k?", "+k:"",l=[b.baseUri,a,"/",h,",",i,k,"?units=",c,"&lang=",d,j].join("");return e.jsonp(g.trustAsResourceUrl(l)).then(function(a){return 200===parseInt(a.status)?a.data:f.reject(a)}).catch(function(a,b,c,d){return f.reject(a)})}function t(){return{nearestStormDistance:"mi",precipIntensity:"in/h",precipIntensityMax:"in/h",precipAccumulation:"in",temperature:"f",temperatureMin:"f",temperatureMax:"f",apparentTemperature:"f",dewPoint:"f",windSpeed:"mph",pressure:"mbar",visibility:"mi"}}function u(){return{nearestStormDistance:"km",precipIntensity:"mm/h",precipIntensityMax:"mm/h",precipAccumulation:"cm",temperature:"c",temperatureMin:"c",temperatureMax:"c",apparentTemperature:"c",dewPoint:"c",windSpeed:"mps",pressure:"hPa",visibility:"km"}}function v(){var a=t();return a.windSpeed="km/h",a}function w(){var a=u();return a.nearestStormDistance=a.visibility="mi",a.windSpeed="mph",a}var h={getCurrent:i,getForecast:j,getDailyForecast:j,getHourlyForecast:k,getMinutelyForecast:l,getAlerts:m,getFlags:n,getUnits:o};return a||console.warn("No Dark Sky API key set."),h}]}function b(a){return{restrict:"E",scope:{icon:"@"},template:'<i class="wi wi-forecast-io-{{ icon }} wi-dark-sky-{{ icon }}"></i>'}}angular.module("dark-sky",[]).provider("darkSky",a).directive("darkSkyIcon",["darkSky",b])}();